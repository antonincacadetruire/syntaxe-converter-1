# Syntaxe Converter

Syntaxe Converter is a powerful CLI tool designed to convert grammars between popular formats: TreeSitter, ANTLR, BNFC, BISON/FLEX, ASDL, and EBNF.

The tool first parses the source syntax into a universal unique language, then generates the equivalent grammar in the chosen target format. This approach ensures reliable, structured, and extensible conversion between different grammar ecosystems.

## Table of Contents
- [**Installation**](#installation-⬇️)
- [**Usage**](#usage-📝)
- [**Important**](#important-⚠️)
- [**Tests**](#tests-👷🏻)
- [**Progression**](#progression-📈)

## Installation ⬇️

Make sure you have OCaml, Dune, and Menhir installed on your system, as well as Node.js and antlr4

```bash
opam install dune menhir
npm i
```

## Usage 📝

Build the project with Dune:

```bash
dune build
```

Run the tool (with CLI options):

```bash
dune exec ./src/main.exe -- --from <source_format> --to <target_format> <input_file> <output_file>
```

Replace `<source_format>`, `<target_format>`, `<input_file>`, and `<output_file>` with your desired formats and file paths.

Example:

```bash
dune exec ./src/main.exe -- --from ebnf --to antlr input.ebnf output.g4
```

To run some test on the grammar you can use :
```bash
antlr4-parse Java8Lexer.g4 Java8Parser.g4 [files.g4, ...] functionStartEOF [compilationUnit] -gui [-tree, -gui]
```

## Important ⚠️

The "options" in antlr files `.g4` should be removed, and the file that is refered to should be copy passed in, and the 
```antlr
parser grammar MyGrammar
```
sould be changed to 
```antlr
grammar MyGrammar
```

##  Tests 👷🏻
```bash
dune exec syntaxe_converter tests/Java8Parser.g4 output.g4
# or
dune exec syntaxe_converter tests/grammar-Java.js output.js
```

## Progression 📈

### July 3rd 📅
The parsing part for `ANTLR`and `Tree-sitter` is done.
There isn't a complete implementation of a traduction from the GrammarTS object to a grammar.js file for now.
There is a translation logic to implement between **Grammar** (`ANTLR`) and **GrammarTS** (`Tree-sitter`)

### Objectives 🎯
The first objective is to translate from `ANTLR` to `Tree-sitter`. The idea is to avoid having to use this huge trees that are being generated by `ANTLR`.
A simplification of `ANTLR` grammar is still possible, as seen below in examples. The simplification is to **flatten** the trees generated by `ANTLR` so that reading them become easy.  
- Original tree generated with this grammar :
![Huge tree](pictures/antlr4_parse_tree.png)
- New tree generated with the simplified grammar :
![Less huge Tree](pictures/antlr4_parse_tree_Modified.png)
The reason why we still want to use `ANTLR` is because of how many grammars and language supports exist for this tool.

### TODO list 🛠️
- [x] Parsing `ANTLR`
- [x] Storing an `ANTLR` grammar into an `OCAML` object (`ANTLR` grammar object)
- [x] Using an `OCAML` obect to generate a grammar in `ANTLR`
- [x] Parsing `Tree-sitter`
- [x] Storing an `Tree-sitter` grammar into an `OCAML` object (`Tree-sitter` grammar object)
- [ ] Using an `OCAML` obect to generate a grammar in `Tree-sitter`
- [ ] Translating an `ANTLR` grammar object into a `Tree-sitter` grammar object

### Process description ⚙️
1. The grammar's type is being identified thanks to its filename extension (⚠️ This tool doesn't verify if the grammar is correct or not)
2. The grammar is then parsed into an `OCAML` object in [this folder](src/from_syntax) with the use of [menhir](https://opam.ocaml.org/packages/menhir/)🪨 (for now, there is a support only for `ANTLR` and `Tree-sitter`)
3. The new grammar object is then automatically converted into a json Object thanks to [yojson](https://opam.ocaml.org/packages/yojson/)
4. It is then archieved into a log folder (Based on the date of the process)
5. It is read back from the json file back into the `OCAML` object and translated back into the type of file it was before (not completed for `Tree-sitter`)

### Documentation 📝
#### Ressources et liens 🔗
- `ANTLR` : [https://www.antlr.org/](https://www.antlr.org/)
- `Tree-sitter` : [https://tree-sitter.github.io/tree-sitter/](https://tree-sitter.github.io/tree-sitter/)
- `Syntaxe-converter` [https://github.com/antonincacadetruire/syntaxe-converter-1](https://github.com/antonincacadetruire/syntaxe-converter-1)
#### Project's structure explanations
- `logs` : [logs' folder](logs)   
The folder where the logs generated automatically are being stored
- `src` : [src's folder](src)  
The folder where the code is.
- `tests` : [tests' folder](tests)  
The folder where all the tested grammars are, and other things as well
- `from_syntax` : [from_syntax's folder](src/from_syntax)  
The folder where the parsing logic is applied
- `to_syntax` : [to_syntax's folder](src/to_syntax)
The folder where the writing logic is applied
- **coming** `translation` which will be a folder about how to transform a grammar into another one.
